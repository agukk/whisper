# Unit 1 実装開始前の確認事項

Unit 1（音声キャプチャ・操作制御）の実装を開始するにあたり、事前に決定が必要な項目をまとめます。

---

## 1. 技術スタック

### 1-1. 開発言語・フレームワーク

macOS ネイティブ機能（メニューバー常駐、グローバルホットキー、マイクアクセス、Accessibility API）を使用するため、**Swift + SwiftUI** が最も自然な選択です。

[Question] Swift + SwiftUI で実装する方針でよろしいですか？他にご希望の技術がありますか？
[Answer]
その方針で大丈夫です。 

### 1-2. プロジェクト管理方式

macOS アプリのプロジェクト管理方式として主に2つの選択肢があります。

| 方式 | メリット | デメリット |
|---|---|---|
| **Xcode プロジェクト（.xcodeproj）** | GUI でビルド設定・署名・権限を管理しやすい。macOS アプリ開発の標準的な方法 | Xcode 依存。xlcodeproj ファイルの差分管理が難しい |
| **Swift Package Manager（Package.swift）** | テキストベースで管理しやすい。CI/CD との相性が良い | GUI アプリの設定（Info.plist, entitlements）は別途手動管理が必要 |

[Question] どちらの方式で管理しますか？
[Answer]
Swift Package Manager（Package.swift）で管理します。

### 1-3. 最小デプロイメントターゲット

使用する macOS API によって対応可能な最小バージョンが変わります。

| macOS バージョン | 主な関連 API |
|---|---|
| macOS 14 (Sonoma) | `MenuBarExtra` の安定版、最新の SwiftUI 機能 |
| macOS 13 (Ventura) | `MenuBarExtra` が初めて導入されたバージョン |
| macOS 12 (Monterey) | `MenuBarExtra` 未対応（`NSStatusItem` で代替必要） |

[Question] 最小対応バージョンはどれにしますか？（例: macOS 14 Sonoma）
[Answer]
macOS 14 Sonoma

---

## 2. アプリケーション設定

### 2-1. アプリ名

[Question] アプリ名は「Whisper」でよろしいですか？別のアプリ名がありますか？
[Answer]
Whisperで大丈夫です。

### 2-2. Bundle Identifier

Apple のアプリ識別子です。通常は `com.<組織名>.<アプリ名>` の形式です。

[Question] Bundle Identifier は何にしますか？（例: `com.yourname.whisper`）
[Answer]
com.nuxxx.whisper

---

## 3. ユーザーインタラクション

### 3-1. デフォルトショートカットキー

fn（Globe）キーの長押しで音声入力を開始・停止します。

[Question] fn（Globe）キーをデフォルトのショートカットとして使用しますか？
[Answer]
ここに関しては、Macでいうと、右のコマンドキーの横にあるfnキーを想定していました。 

### 3-2. メニューバーアイコン

メニューバーに表示するアイコンのデザインについて。

[Question] メニューバーアイコンは macOS 標準の SF Symbols（例:マイクアイコン `mic.fill`）を使用しますか？独自のアイコンを用意しますか？
[Answer]
macOS 標準の SF Symbolsを使用します。

---

## 4. 権限・セキュリティ

### 4-1. 必要な macOS 権限

Unit 1 の実装には以下の macOS 権限が必要です。これらは初回起動時にユーザーに許可を求めるダイアログが表示されます。

| 権限 | 用途 | 必要な理由 |
|---|---|---|
| **マイクアクセス** | 音声キャプチャ | US-001: プッシュトゥトーク方式で音声入力を行うため |
| **アクセシビリティ** | アクティブウィンドウ情報取得、グローバルホットキー | US-009: グローバルショートカット、US-010: アクティブフィールドへの入力 |
| **入力監視** | グローバルホットキーのキーイベント監視 | US-009: どのアプリからでも fn（Globe）キーで音声入力を制御するため |

[Question] これらの権限を使用することに問題はありませんか？確認事項があればご記入ください。
[Answer]
問題ありません。 
---

## 5. Unit 2 / Unit 3 との結合方針

### 5-1. スタブ実装

Unit 2（音声認識エンジン）と Unit 3（テキスト処理・出力）はまだ未実装のため、Unit 1 単体で動作確認可能にする必要があります。

| 境界インターフェース | スタブ方針 |
|---|---|
| AudioStreamOutput（→ Unit 2） | 音声データをキャプチャするが、送信先はログ出力のみ |
| CaptureControlSignal（→ Unit 2） | 開始/停止イベントをログ出力 |
| ActiveWindowInfo（→ Unit 3） | アクティブウィンドウ情報を取得するが、利用先はログ出力のみ |

[Question] スタブの方針で問題ありませんか？他にご希望の動作がありますか？
[Answer]
スタブの方針で問題ありません。 
---

## 回答状況

| # | 項目 | 回答状況 |
|---|---|---|
| 1-1 | 開発言語 | ⬜ 未回答 |
| 1-2 | プロジェクト管理方式 | ⬜ 未回答 |
| 1-3 | 最小デプロイメントターゲット | ⬜ 未回答 |
| 2-1 | アプリ名 | ⬜ 未回答 |
| 2-2 | Bundle Identifier | ⬜ 未回答 |
| 3-1 | デフォルトショートカットキー | ⬜ 未回答 |
| 3-2 | メニューバーアイコン | ⬜ 未回答 |
| 4-1 | 権限・セキュリティ | ⬜ 未回答 |
| 5-1 | スタブ実装方針 | ⬜ 未回答 |
