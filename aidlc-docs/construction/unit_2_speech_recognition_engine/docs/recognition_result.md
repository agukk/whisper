# RecognitionResult（認識結果）

## 概要

音声認識エンジンが生成した認識結果を表すドメインモデル。認識されたテキストは言語ごとのセグメントに分割され、各セグメントに言語ラベルが付与される。

対応ユーザーストーリー: **US-002**（日本語認識）、**US-003**（英語認識）、**US-004**（日英混合認識）

---

## コンポーネント種別

**エンティティ（Entity）**

---

## 属性

| 属性名 | 型 | 説明 |
|---|---|---|
| resultId | 一意識別子 | 認識結果を一意に識別するID |
| segments | RecognitionSegment のリスト（値オブジェクト） | 言語ごとに分割された認識セグメントの順序付きリスト |
| createdAt | タイムスタンプ | 認識結果が生成された時刻 |
| fullText | 文字列（導出属性） | 全セグメントを連結した完全なテキスト |

---

## 値オブジェクト

### RecognitionSegment（認識セグメント）

認識結果を構成する、同一言語の連続テキスト区間を表す値オブジェクト。

| 属性名 | 型 | 説明 |
|---|---|---|
| text | 文字列 | 認識されたテキスト |
| language | Language（値オブジェクト） | このセグメントの言語 |
| order | 整数 | セグメントの出現順序 |

### Language（言語）

対応する言語を表す値オブジェクト。現時点では日本語と英語の2言語に限定。

| 値 | 説明 |
|---|---|
| Japanese | 日本語 |
| English | 英語 |

---

## 振る舞い

| メソッド | 説明 | 事前条件 | 事後条件 |
|---|---|---|---|
| addSegment(segment) | 認識セグメントを追加する | segment が有効であること | segments リストにセグメントが追加される |
| getFullText() | 全セグメントを連結した完全なテキストを返す | — | 全セグメントの text を order 順に連結した文字列を返す |
| getSegmentsByLanguage(language) | 指定言語のセグメントのみを返す | — | 指定言語に一致するセグメントのリストを返す |

---

## ドメインイベント

| イベント名 | 発生タイミング | ペイロード | 備考 |
|---|---|---|---|
| RecognitionCompleted | 音声認識が完了し、結果が確定した時 | resultId, segments, fullText | Unit 3 へリライト対象テキストの送信を通知 |

---

## ビジネスルール

1. 各セグメントのテキストには、対応する言語の句読点（日本語: 、。/ 英語: , .）が適切に挿入されている
2. 日英混合の発話では、言語の切り替わりが自動的に検出され、別のセグメントとして分割される
3. ユーザーが手動で言語を切り替える必要はない
4. セグメントの order は発話の時系列順を保持する
