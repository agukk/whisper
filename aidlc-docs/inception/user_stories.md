# 音声入力アプリ - ユーザーストーリー

## プロジェクト概要

- **アプリ概要**: Wispr Flow のようなデスクトップ音声入力アプリ（macOS）
- **主な目的**: 音声メッセージのリアルタイム文字起こし
- **対応言語**: 日本語、英語（混合対応含む）
- **技術構成**: Apple SpeechAnalyzer（音声認識）+ Gemini Flash（テキストリライト・精度補正）
- **利用形態**: 個人利用
- **コスト方針**: なるべくコストをかけない

---

## ユーザーストーリー一覧

### US-001: 音声認識の開始と停止（プッシュトゥトーク方式）

**ユーザーストーリー:**
ユーザーとして、1つのボタン（またはキー）を押し続けている間だけ音声認識が行われ、ボタンを離すと停止するようにしたい。それにより、直感的な操作で必要なときだけ音声入力を行うことができる。

**受け入れ基準:**
- [ ] アプリ上に1つの音声認識ボタンが存在する（プッシュトゥトーク方式）
- [ ] ボタンを押し続けている間、マイクからの音声入力・認識が行われる
- [ ] ボタンを離すと音声入力が停止され、認識結果のテキストがアクティブなテキストフィールドに入力される
- [ ] キーボードショートカット（キー長押し）でも同様の操作ができる
- [ ] 録音中であることがUI上で明確に区別できる（例：ボタンの色変化、アニメーション など）

---

### US-002: 日本語での音声認識

**ユーザーストーリー:**
ユーザーとして、日本語で話した内容が正確にテキストに変換されるようにしたい。それにより、日本語での音声入力を行うことができる。

**受け入れ基準:**
- [ ] 日本語の音声がテキストに正確に変換される
- [ ] 日本語の句読点（、。）が適切に挿入される
- [ ] 一般的な日本語の語彙が正しく認識される

---

### US-003: 英語での音声認識

**ユーザーストーリー:**
ユーザーとして、英語で話した内容が正確にテキストに変換されるようにしたい。それにより、英語での音声入力を行うことができる。

**受け入れ基準:**
- [ ] 英語の音声がテキストに正確に変換される
- [ ] 英語の句読点（, .）が適切に挿入される
- [ ] 一般的な英語の語彙が正しく認識される

---

### US-004: 日英混合音声の認識

**ユーザーストーリー:**
ユーザーとして、日本語と英語を混ぜて話した場合でも、それぞれの言語が正確にテキストに変換されるようにしたい。それにより、日常的に日英を切り替えながら話す場面でもスムーズに音声入力を利用できる。

**受け入れ基準:**
- [ ] 一つの発話の中で日本語と英語が混在していても認識できる
- [ ] 日本語部分は日本語テキストとして、英語部分は英語テキストとして正しく変換される
- [ ] 言語の切り替わりが自然に検出される（ユーザーが手動で切り替える必要がない）

---

### US-005: 認識言語の設定（複数言語対応）

**ユーザーストーリー:**
ユーザーとして、音声認識の対象言語を複数同時に設定できるようにしたい。それにより、日本語と英語の両方を認識対象として設定し、混合音声にも対応できる。

**受け入れ基準:**
- [ ] UI上で認識対象言語を複数選択できる（例：日本語と英語を同時選択）
- [ ] 選択された複数の言語に基づいて音声認識エンジンが動作する
- [ ] 現在設定中の言語がUI上で一覧として確認できる
- [ ] 言語の追加・削除が容易に行える

---

### US-006: Gemini Flash によるテキストリライト

**ユーザーストーリー:**
ユーザーとして、音声認識で生成されたテキストを Gemini Flash で自動的にリライト・精度補正できるようにしたい。それにより、認識ミスやフィラーワードが除去された、より正確で読みやすいテキストを得ることができる。

**受け入れ基準:**
- [ ] 音声認識で生成されたテキストを Gemini Flash API に送信してリライトできる
- [ ] リライト後のテキストがアクティブなテキストフィールドに入力される
- [ ] フィラーワード（えーと、あのー、um、uh など）が除去される
- [ ] 文法的に正しいテキストに修正される
- [ ] 日英混合テキストも適切にリライトされる

---

### US-007: テキストのクリップボードコピー

**ユーザーストーリー:**
ユーザーとして、変換されたテキストをクリップボードにコピーできるようにしたい。それにより、他のアプリケーションにテキストを貼り付けて利用できる。

**受け入れ基準:**
- [ ] コピーボタンまたはキーボードショートカットでテキストをクリップボードにコピーできる
- [ ] コピー成功時にフィードバック（通知やUIの変化）が表示される

---

### US-008: アプリのメニューバー常駐

**ユーザーストーリー:**
ユーザーとして、アプリが macOS のメニューバーに常駐するようにしたい。それにより、いつでも素早く音声入力を開始できる。

**受け入れ基準:**
- [ ] アプリが macOS メニューバーにアイコンとして常駐する
- [ ] メニューバーアイコンをクリックすると音声認識の開始/停止ができる
- [ ] メニューバーから設定画面にアクセスできる
- [ ] アプリはバックグラウンドで動作し続ける

---

### US-009: グローバルショートカットキー

**ユーザーストーリー:**
ユーザーとして、他のアプリを使用中でもグローバルショートカットキーで音声入力を開始・停止できるようにしたい。それにより、どのアプリを使用中でも素早く音声入力を利用できる。

**受け入れ基準:**
- [ ] 設定画面でグローバルショートカットキーを設定できる
- [ ] どのアプリがフォーカスされていても、ショートカットキーで音声認識を開始/停止できる
- [ ] ショートカットキーが他のアプリのショートカットと競合しないようにデフォルトが設定されている

---

### US-010: アクティブなテキストフィールドへの直接入力

**ユーザーストーリー:**
ユーザーとして、音声認識で変換されたテキストが、現在アクティブなテキストフィールド（たとえば、メールの入力欄やチャットアプリのメッセージ欄）に直接入力されるようにしたい。それにより、Wispr Flow のようにシームレスに音声で文字入力ができる。

**受け入れ基準:**
- [ ] 開始→音声入力→停止の流れで、停止後にテキストがアクティブなテキストフィールドに自動入力される
- [ ] macOS の各種アプリケーション（テキストエディタ、ブラウザ、メールクライアント、チャットアプリなど）で動作する
- [ ] 既存のテキストに追記する形で入力される（上書きしない）
- [ ] Gemini Flash でリライトされた場合は、リライト後のテキストが入力される

---

## MoSCoW 優先順位付け

ユーザーの要件（「まずはリアルタイム音声認識→テキスト変換」「コスト重視」）を考慮し、以下の優先順位を設定しました。

### Must（必須）— MVP に含める

| ID | ユーザーストーリー | 理由 |
|---|---|---|
| US-001 | 音声認識の開始と停止（プッシュトゥトーク方式） | コア機能。音声入力のトリガーがなければアプリが成立しない |
| US-002 | 日本語での音声認識 | 対応必須言語 |
| US-003 | 英語での音声認識 | 対応必須言語 |
| US-010 | アクティブなテキストフィールドへの直接入力 | Wispr Flow 同様の体験を実現するコア機能 |

### Should（重要）— MVP 後の早期対応

| ID | ユーザーストーリー | 理由 |
|---|---|---|
| US-004 | 日英混合音声の認識 | 日常的に日英を混ぜて話す場面への対応。コア体験の品質向上に必要 |
| US-005 | 認識言語の設定（複数言語対応） | 混合音声対応の基盤となる設定機能 |
| US-006 | Gemini Flash によるテキストリライト | 精度補正によるユーザー体験の大幅な向上 |
| US-009 | グローバルショートカットキー | どのアプリからでも使えることが実用上重要 |

### Could（あると良い）— 余裕があれば対応

| ID | ユーザーストーリー | 理由 |
|---|---|---|
| US-007 | テキストのクリップボードコピー | US-010 で直接入力できるため、補助的機能 |
| US-008 | アプリのメニューバー常駐 | 利便性向上だが、MVP ではウィンドウアプリでも可 |

### Won't（今回は対応しない）

- 現時点では Won't に分類するストーリーはありません

